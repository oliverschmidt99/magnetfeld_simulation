<!DOCTYPE html>
{% extends "base.html" %}

{% block title %}Bauteil-Editor{% endblock %}

{% block sub_nav %}
<div class="sub-nav-bar">
    <h2>Bauteile bearbeiten</h2>
</div>
{% endblock %}

{% block content %}
<script id="library-data" type="application/json">
    {{ library|tojson|safe }}
</script>

<div class="container">

    <div class="card-container" id="bauteile-nav">
        <div class="card active" data-target="bauteil-rails">
            <h3>Stromschienen</h3>
            <p>Kupferschienen verwalten.</p>
        </div>
        <div class="card" data-target="bauteil-transformers">
            <h3>Wandler</h3>
            <p>Stromwandler verwalten.</p>
        </div>
        <div class="card" data-target="bauteil-sheets">
            <h3>Abschirmbleche</h3>
            <p>Trafobleche verwalten.</p>
        </div>
    </div>

    <hr>

    <div id="bauteil-sections">

        <div id="bauteil-rails" class="config-section active">
            <div class="component-editor">
                <div class="component-preview">
                    <div class="preview-header">
                        <h3>Live-Vorschau</h3>
                        <button class="zoom-preview-btn" data-form-id="rail-form"
                            title="Vorschau vergr√∂√üern">üîç</button>
                    </div>
                    <svg id="rail-preview-svg"></svg>
                </div>
                <div class="component-form">
                    <h3 id="rail-form-title">Neue Stromschiene erstellen</h3>
                    <form id="rail-form" data-type="copperRails">
                        <input type="hidden" id="rail-original-name">
                        <div class="form-grid">
                            <div class="form-section">
                                <h4>Allgemeine Produktinformationen</h4>
                                <div class="form-group"><label for="rail-name">Name (Eindeutige ID)</label><input
                                        type="text" id="rail-name" required></div>
                                <div class="form-group"><label for="rail-productName">Produktbezeichnung</label><input
                                        type="text" id="rail-productName"></div>
                                <div class="form-group"><label for="rail-manufacturer">Hersteller</label><input
                                        type="text" id="rail-manufacturer"></div>
                                <div class="form-group"><label>Tags</label>
                                    <div id="rail-tags-selection" class="tags-input-container"><button type="button"
                                            class="add-tags-btn">+ Tags hinzuf√ºgen</button></div>
                                </div>
                            </div>
                            <div class="form-section">
                                <h4>Geometrie & Material</h4>
                                <div class="form-group"><label for="rail-material">Material</label><input type="text"
                                        id="rail-material" value="Copper"></div>
                                <div class="form-group"><label for="rail-width">Breite (mm)</label><input type="number"
                                        step="any" id="rail-width"></div>
                                <div class="form-group"><label for="rail-height">H√∂he (mm)</label><input type="number"
                                        step="any" id="rail-height"></div>
                            </div>
                        </div>
                        <div class="button-group">
                            <button type="submit">Speichern</button>
                            <button type="button" class="clear-btn">Formular leeren</button>
                        </div>
                    </form>
                </div>
            </div>
            <hr>
            <h2>Vorhandene Stromschienen</h2>
            <div class="component-list-accordion" id="rails-list"></div>
        </div>

        <div id="bauteil-transformers" class="config-section">
            <div class="component-editor">
                <div class="component-preview">
                    <div class="preview-header">
                        <h3>Live-Vorschau</h3>
                        <button class="zoom-preview-btn" data-form-id="transformer-form"
                            title="Vorschau vergr√∂√üern">üîç</button>
                    </div>
                    <svg id="transformer-preview-svg"></svg>
                </div>
                <div class="component-form">
                    <h3 id="transformer-form-title">Neuen Wandler erstellen</h3>
                    <form id="transformer-form" data-type="transformers">
                        <input type="hidden" id="transformer-original-name">
                        <div class="form-grid">
                            <div class="form-section">
                                <h4>Allgemeine Informationen</h4>
                                <div class="form-group"><label>Name (ID)</label><input type="text" id="transformer-name"
                                        required></div>
                                <div class="form-group"><label>Hersteller</label><input type="text"
                                        id="transformer-manufacturer"></div>
                                <div class="form-group"><label>Produktname</label><input type="text"
                                        id="transformer-productName"></div>
                                <div class="form-group"><label>Tags</label>
                                    <div id="transformer-tags-selection" class="tags-input-container"><button
                                            type="button" class="add-tags-btn">+ Tags hinzuf√ºgen</button></div>
                                </div>
                            </div>
                            <div class="form-section">
                                <h4>Elektrische Eigenschaften</h4>
                                <div class="form-group"><label>Prim√§rstrom (A)</label><input type="number"
                                        id="transformer-primaryRatedCurrentA"></div>
                                <div class="form-group"><label>Sekund√§rstrom (A)</label><input type="number"
                                        id="transformer-secondaryRatedCurrentA"></div>
                                <div class="form-group"><label>B√ºrde (VA)</label><input type="number" step="any"
                                        id="transformer-burdenVA"></div>
                            </div>
                            <div class="form-section">
                                <h4>Material & Tiefe</h4>
                                <div class="form-group"><label>Kernmaterial</label><input type="text"
                                        id="transformer-coreMaterial" value="M-36 Steel"></div>
                                <div class="form-group"><label>Spaltmaterial</label><input type="text"
                                        id="transformer-gapMaterial" value="Air"></div>
                                <div class="form-group"><label>Tiefe (mm)</label><input type="number" step="any"
                                        id="transformer-depth"></div>
                            </div>
                            <div class="form-section">
                                <h4>Geometrie (mm)</h4>
                                <div class="form-row">
                                    <div class="form-group"><label>Luft Au√üen B</label><input type="number" step="any"
                                            id="transformer-outerAirWidth"></div>
                                    <div class="form-group"><label>Luft Au√üen H</label><input type="number" step="any"
                                            id="transformer-outerAirHeight"></div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group"><label>Kern Au√üen B</label><input type="number" step="any"
                                            id="transformer-coreOuterWidth"></div>
                                    <div class="form-group"><label>Kern Au√üen H</label><input type="number" step="any"
                                            id="transformer-coreOuterHeight"></div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group"><label>Kern Innen B</label><input type="number" step="any"
                                            id="transformer-coreInnerWidth"></div>
                                    <div class="form-group"><label>Kern Innen H</label><input type="number" step="any"
                                            id="transformer-coreInnerHeight"></div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group"><label>Innen B</label><input type="number" step="any"
                                            id="transformer-innerWidth"></div>
                                    <div class="form-group"><label>Innen H</label><input type="number" step="any"
                                            id="transformer-innerHeight"></div>
                                </div>
                            </div>
                        </div>
                        <div class="button-group">
                            <button type="submit">Speichern</button>
                            <button type="button" class="clear-btn">Formular leeren</button>
                        </div>
                    </form>
                </div>
            </div>
            <hr>
            <h2>Vorhandene Wandler</h2>
            <div class="component-list-accordion" id="transformers-list"></div>
        </div>

        <div id="bauteil-sheets" class="config-section">
            <div class="component-editor">
                <div class="component-preview">
                    <div class="preview-header">
                        <h3>Live-Vorschau</h3>
                        <button class="zoom-preview-btn" data-form-id="sheet-form"
                            title="Vorschau vergr√∂√üern">üîç</button>
                    </div>
                    <svg id="sheet-preview-svg"></svg>
                </div>
                <div class="component-form">
                    <h3 id="sheet-form-title">Neues Abschirmblech erstellen</h3>
                    <form id="sheet-form" data-type="transformerSheets">
                        <input type="hidden" id="sheet-original-name">
                        <div class="form-grid">
                            <div class="form-section">
                                <h4>Allgemeine Informationen</h4>
                                <div class="form-group"><label>Name (ID)</label><input type="text" id="sheet-name"
                                        required></div>
                                <div class="form-group"><label>Hersteller</label><input type="text"
                                        id="sheet-manufacturer" value="Standard"></div>
                                <div class="form-group"><label>Produktname</label><input type="text"
                                        id="sheet-productName"></div>
                                <div class="form-group"><label>Tags</label>
                                    <div id="sheet-tags-selection" class="tags-input-container"><button type="button"
                                            class="add-tags-btn">+ Tags hinzuf√ºgen</button></div>
                                </div>
                            </div>
                            <div class="form-section">
                                <h4>Geometrie & Material</h4>
                                <div class="form-group"><label>Material</label><input type="text" id="sheet-material"
                                        value="M-36 Steel"></div>
                                <div class="form-group"><label>Breite (mm)</label><input type="number" step="any"
                                        id="sheet-width"></div>
                                <div class="form-group"><label>H√∂he (mm)</label><input type="number" step="any"
                                        id="sheet-height"></div>
                            </div>
                        </div>
                        <div class="button-group">
                            <button type="submit">Speichern</button>
                            <button type="button" class="clear-btn">Formular leeren</button>
                        </div>
                    </form>
                </div>
            </div>
            <hr>
            <h2>Vorhandene Abschirmbleche</h2>
            <div class="component-list-accordion" id="sheets-list"></div>
        </div>

    </div>
</div>

<div id="preview-modal-overlay" class="modal-overlay" style="display: none;">
    <div class="preview-modal-content">
        <button id="preview-modal-close" class="modal-close-btn">&times;</button>
        <svg id="modal-preview-svg"></svg>
    </div>
</div>

<div id="tag-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <h3>Tags ausw√§hlen</h3>
        <div id="modal-selected-tags" class="tags-input-container"></div>
        <div class="search-container">
            <input type="text" id="tag-search-input" placeholder="Tags suchen...">
        </div>
        <div id="modal-tag-list" class="modal-tag-list">
        </div>
        <div class="button-group">
            <button type="button" id="modal-save-btn">Fertig</button>
            <button type="button" id="modal-cancel-btn" class="secondary">Abbrechen</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/bauteile.js') }}"></script>
{% endblock %}
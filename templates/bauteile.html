<!DOCTYPE html>
{% extends "base.html" %}

{% block title %}Bauteil-Editor{% endblock %}

{% block sub_nav %}
<div class="sub-nav-bar">
    <h2>Bauteile bearbeiten</h2>
</div>
{% endblock %}

{% block content %}
<script id="library-data" type="application/json">
    {{ library|tojson|safe }}
</script>

<div class="container">

    <div class="card-container" id="bauteile-nav">
        <div class="card active" data-target="bauteil-rails">
            <h3>Stromschienen</h3>
            <p>Kupferschienen verwalten.</p>
        </div>
        <div class="card" data-target="bauteil-transformers">
            <h3>Wandler</h3>
            <p>Stromwandler verwalten.</p>
        </div>
        <div class="card" data-target="bauteil-sheets">
            <h3>Abschirmbleche</h3>
            <p>Trafobleche verwalten.</p>
        </div>
    </div>

    <hr>

    <div id="bauteil-sections">

        <div id="bauteil-rails" class="config-section active">
            <div class="component-editor">
                <div class="component-form">
                    <h3 id="rail-form-title">Neue Stromschiene erstellen</h3>
                    <form id="rail-form">
                        <input type="hidden" id="rail-original-name">
                        <div class="form-group">
                            <label for="rail-name">Name</label>
                            <input type="text" id="rail-name" required>
                        </div>
                        <div class="form-group">
                            <label for="rail-manufacturer">Hersteller</label>
                            <input type="text" id="rail-manufacturer">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="rail-width">Breite (mm)</label>
                                <input type="number" id="rail-width" value="40">
                            </div>
                            <div class="form-group">
                                <label for="rail-height">Höhe (mm)</label>
                                <input type="number" id="rail-height" value="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Tags</label>
                            <div id="rail-tags-selection" class="tags-input-container">
                                <button type="button" class="add-tags-btn">+ Tags hinzufügen</button>
                            </div>
                        </div>
                        <div class="button-group">
                            <button type="submit">Speichern</button>
                            <button type="button" id="rail-clear-btn">Formular leeren</button>
                        </div>
                    </form>
                </div>
                <div class="component-preview">
                    <h3>Live-Vorschau</h3>
                    <svg id="rail-preview-svg"></svg>
                </div>
            </div>

            <hr>

            <h2>Vorhandene Stromschienen</h2>
            <div class="filter-bar">
                <div class="form-group">
                    <input type="text" id="rail-search" placeholder="Namen durchsuchen...">
                </div>
                <div class="form-group">
                    <select id="rail-filter-tag">
                        <option value="">Nach Tag filtern...</option>
                    </select>
                </div>
                <div class="form-group">
                    <select id="rail-filter-manufacturer">
                        <option value="">Nach Hersteller filtern...</option>
                    </select>
                </div>
            </div>

            <div class="component-list-accordion" id="rails-list">
            </div>
        </div>

        <div id="bauteil-transformers" class="config-section">
            <h2>Wandler (Transformers)</h2>
            <p>Dieser Bereich wird in Kürze implementiert.</p>
        </div>

        <div id="bauteil-sheets" class="config-section">
            <h2>Abschirmbleche (Transformer Sheets)</h2>
            <p>Dieser Bereich wird in Kürze implementiert.</p>
        </div>

    </div>
</div>

<div id="tag-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <h3>Tags auswählen</h3>
        <div id="modal-selected-tags" class="tags-input-container"></div>
        <div class="search-container">
            <input type="text" id="tag-search-input" placeholder="Tags suchen...">
        </div>
        <div id="modal-tag-list" class="modal-tag-list">
        </div>
        <div class="button-group">
            <button type="button" id="modal-save-btn">Fertig</button>
            <button type="button" id="modal-cancel-btn" class="secondary">Abbrechen</button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/bauteile.js') }}"></script>
{% endblock %}
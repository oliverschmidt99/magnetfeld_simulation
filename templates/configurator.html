<!DOCTYPE html>
{% extends "base.html" %}

{% block title %}Simulations-Konfigurator{% endblock %}

{% block sub_nav %}
<div class="sub-nav-bar">
    <h2>Simulation Konfigurieren</h2>
</div>
{% endblock %}

{% block content %}
<script id="library-data" type="application/json">
    {{ library|tojson|safe }}
</script>
<div class="container">
    <div class="card-container" id="config-nav">
        <div class="card active" data-target="config-summary">
            <h3>Übersicht & Speichern</h3>
        </div>
        <div class="card" data-target="config-params">
            <h3>Globale Parameter</h3>
        </div>
        <div class="card" data-target="config-phases">
            <h3>Elektrisches System</h3>
        </div>
        <div class="card" data-target="config-assemblies">
            <h3>Baugruppen</h3>
        </div>
        <div class="card" data-target="config-standalone">
            <h3>Einzelbauteile</h3>
        </div>
    </div>
    <hr>
    <form id="simulation-form">
        <div id="config-sections">
            <div id="config-summary" class="config-section active">
                <h2>Übersicht & Speichern</h2>
                <p>Hier siehst du eine Zusammenfassung deiner aktuellen Konfiguration. Du kannst sie als Szenario
                    speichern, um sie später wiederzuverwenden.</p>
                <div class="summary-box" id="summary-output"></div>
                <hr>
                <div class="form-group-wrapper">
                    <h4>Szenario-Verwaltung</h4>
                    <div class="form-group">
                        <label for="scenario-name">Szenario-Name:</label>
                        <input type="text" id="scenario-name" placeholder="z.B. Standard-Aufbau_500A">
                    </div>
                    <div class="button-group">
                        <button type="button" id="save-scenario-btn" class="button add">Szenario speichern</button>
                    </div>
                    <div class="form-group" style="margin-top: 1.5rem;">
                        <label for="saved-scenarios">Gespeicherte Szenarien laden:</label>
                        <select id="saved-scenarios">
                            <option value="">-- Szenario auswählen --</option>
                        </select>
                    </div>
                    <div class="button-group">
                        <button type="button" id="load-scenario-btn" class="button">Laden</button>
                        <button type="button" id="delete-scenario-btn" class="button danger">Löschen</button>
                    </div>
                </div>
            </div>

            <div id="config-params" class="config-section">
                <h2>Globale Simulations-Parameter</h2>
                <div class="form-group-wrapper">
                    <div class="form-group">
                        <label for="frequencyHz">Frequenz (Hz)</label>
                        <input type="number" id="frequencyHz" value="50">
                    </div>
                    <div class="form-group">
                        <label for="problemDepthM">Problem-Tiefe (mm)</label>
                        <input type="number" step="any" id="problemDepthM" value="30">
                    </div>
                    <div class="form-group">
                        <label for="coreRelPermeability">Relative Permeabilität (Kern)</label>
                        <input type="number" step="any" id="coreRelPermeability" value="2500">
                    </div>
                </div>
            </div>

            <div id="config-phases" class="config-section">
                <h2>Elektrisches System (Phasen)</h2>
                <div id="electrical-system-list" class="dynamic-list"></div>
                <button type="button" onclick="addPhase()" class="button secondary">+ Phase hinzufügen</button>
            </div>

            <div id="config-assemblies" class="config-section">
                <h2>Baugruppen (Assemblies)</h2>
                <div id="assemblies-list" class="dynamic-list"></div>
                <button type="button" onclick="addAssembly()" class="button secondary">+ Baugruppe hinzufügen</button>
            </div>

            <div id="config-standalone" class="config-section">
                <h2>Eigenständige Bauteile</h2>
                <div id="standalone-list" class="dynamic-list"></div>
                <button type="button" onclick="addStandalone()" class="button secondary">+ Bauteil hinzufügen</button>
            </div>
        </div>
        <hr>
        <button type="submit" class="button add">simulation.json erstellen</button>
    </form>
</div>
{% endblock %}

{% block scripts %}
{# KORREKTER PFAD ZUR JAVASCRIPT-DATEI #}
<script src="{{ url_for('static', filename='js/configurator.js') }}"></script>
{% endblock %}
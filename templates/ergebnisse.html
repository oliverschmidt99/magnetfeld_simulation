<!DOCTYPE html>
{% extends "base.html" %}
{% block title %}Ergebnisse vergleichen{% endblock %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/results.css') }}">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<div class="container results-comparison-container">
    <div class="sub-nav-bar">
        <h2>Simulationsergebnisse vergleichen</h2>
    </div>

    <div class="top-controls card">
        <h3>Vergleichssteuerung</h3>
        <div class="results-filter-container">
            <div class="form-group">
                <label for="run-selector-1">Simulationslauf 1 (Links)</label>
                <select id="run-selector-1"></select>
            </div>
            <div class="form-group">
                <label for="run-selector-2">Simulationslauf 2 (Rechts)</label>
                <select id="run-selector-2"></select>
            </div>
            <div class="form-group">
                <button type="button" id="sync-btn" class="button secondary">↙️ Auswahl von Links übernehmen</button>
            </div>
        </div>
        <div id="conductor-selector" class="conductor-selector"></div>
    </div>

    <div class="card animation-controls global-femm-controls">
        <h3>Globale FEMM-Plot Steuerung</h3>
        <div class="plot-slider-container global-controls">
            <button type="button" id="play-pause-sync-btn" class="play-btn" disabled>▶</button>
            <label for="speed-slider-global">Geschwindigkeit:</label>
            <input type="range" id="speed-slider-global" min="0" max="7" step="1" value="3">
            <span id="speed-display-global">1.00x</span>
            <label for="angle-slider-global">Phasenwinkel:</label>
            <input type="range" id="angle-slider-global" min="0" max="0" step="1" disabled>
            <span id="angle-display-global">0°</span>
        </div>
    </div>

    <div class="comparison-content">
        <div class="comparison-column" id="column-1">
            <div class="card">
                <h3>Diagramm: Lauf 1</h3>
                <div class="chart-controls">
                    <div class="form-group">
                        <label for="current-selector-1">Primärstrom</label>
                        <select id="current-selector-1" disabled></select>
                    </div>
                    <div class="form-group">
                        <label for="y-axis-selector-1">Y-Achse</label>
                        <select id="y-axis-selector-1" disabled></select>
                    </div>
                    <div class="form-group complex-part-selector initially-hidden">
                        <label>Darstellung</label>
                        <div class="button-group-radio">
                            <input type="radio" id="part-abs-1" name="part-selector-1" value="abs" checked><label
                                for="part-abs-1">Betrag</label>
                            <input type="radio" id="part-real-1" name="part-selector-1" value="real"><label
                                for="part-real-1">Real</label>
                            <input type="radio" id="part-imag-1" name="part-selector-1" value="imag"><label
                                for="part-imag-1">Imaginär</label>
                        </div>
                    </div>
                </div>
                <div class="plot-container">
                    <p id="loading-message-1" class="loading-message">Lade Diagramm...</p>
                    <div id="plot-div-1" class="initially-hidden">
                        <canvas id="plot-canvas-1"></canvas>
                    </div>
                </div>
            </div>
            <div id="results-preview-container-1" class="preview-section card">
                <h3>Simulations-Vorschau: Lauf 1</h3>
                <p id="preview-loading-message-1" class="loading-message">Lade Vorschau...</p>
            </div>
            <div id="femm-plots-container-1" class="preview-section card initially-hidden">
                <h3>FEMM-Analyse-Plot: Lauf 1</h3>
                <div class="plot-slider-container">
                    <button type="button" id="play-pause-btn-1" class="play-btn" disabled>▶</button>
                    <label for="speed-slider-1">Geschw.:</label>
                    <input type="range" id="speed-slider-1" class="speed-slider-local" min="0" max="7" step="1"
                        value="3">
                    <span id="speed-display-1">1.00x</span>
                    <label for="angle-slider-1">Winkel:</label>
                    <input type="range" id="angle-slider-1" class="angle-slider-local" min="0" max="0" step="1"
                        disabled>
                    <span id="angle-display-1">0°</span>
                </div>
                <div class="femm-plot">
                    <p id="density-plot-loading-1" class="loading-message">Lade Plot...</p>
                    <div id="density-plot-wrapper-1" class="plot-image-wrapper">
                        <img id="density-plot-img-1" src="#_" alt="Dichte-Plot der Feldstärke H"
                            class="femm-plot-image initially-hidden">
                        <div class="zoom-controls">
                            <button type="button" id="zoom-home-btn-1" title="Zoom zurücksetzen">⌂</button>
                            <button type="button" id="zoom-in-btn-1" title="Vergrößern">+</button>
                            <button type="button" id="zoom-out-btn-1" title="Verkleinern">-</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="comparison-column" id="column-2">
            <div class="card">
                <h3>Diagramm: Lauf 2</h3>
                <div class="chart-controls">
                    <div class="form-group">
                        <label for="current-selector-2">Primärstrom</label>
                        <select id="current-selector-2" disabled></select>
                    </div>
                    <div class="form-group">
                        <label for="y-axis-selector-2">Y-Achse</label>
                        <select id="y-axis-selector-2" disabled></select>
                    </div>
                    <div class="form-group complex-part-selector initially-hidden">
                        <label>Darstellung</label>
                        <div class="button-group-radio">
                            <input type="radio" id="part-abs-2" name="part-selector-2" value="abs" checked><label
                                for="part-abs-2">Betrag</label>
                            <input type="radio" id="part-real-2" name="part-selector-2" value="real"><label
                                for="part-real-2">Real</label>
                            <input type="radio" id="part-imag-2" name="part-selector-2" value="imag"><label
                                for="part-imag-2">Imaginär</label>
                        </div>
                    </div>
                </div>
                <div class="plot-container">
                    <p id="loading-message-2" class="loading-message">Lade Diagramm...</p>
                    <div id="plot-div-2" class="initially-hidden">
                        <canvas id="plot-canvas-2"></canvas>
                    </div>
                </div>
            </div>
            <div id="results-preview-container-2" class="preview-section card">
                <h3>Simulations-Vorschau: Lauf 2</h3>
                <p id="preview-loading-message-2" class="loading-message">Lade Vorschau...</p>
            </div>
            <div id="femm-plots-container-2" class="preview-section card initially-hidden">
                <h3>FEMM-Analyse-Plot: Lauf 2</h3>
                <div class="plot-slider-container">
                    <button type="button" id="play-pause-btn-2" class="play-btn" disabled>▶</button>
                    <label for="speed-slider-2">Geschw.:</label>
                    <input type="range" id="speed-slider-2" class="speed-slider-local" min="0" max="7" step="1"
                        value="3">
                    <span id="speed-display-2">1.00x</span>
                    <label for="angle-slider-2">Winkel:</label>
                    <input type="range" id="angle-slider-2" class="angle-slider-local" min="0" max="0" step="1"
                        disabled>
                    <span id="angle-display-2">0°</span>
                </div>
                <div class="femm-plot">
                    <p id="density-plot-loading-2" class="loading-message">Lade Plot...</p>
                    <div id="density-plot-wrapper-2" class="plot-image-wrapper">
                        <img id="density-plot-img-2" src="#_" alt="Dichte-Plot der Feldstärke H"
                            class="femm-plot-image initially-hidden">
                        <div class="zoom-controls">
                            <button type="button" id="zoom-home-btn-2" title="Zoom zurücksetzen">⌂</button>
                            <button type="button" id="zoom-in-btn-2" title="Vergrößern">+</button>
                            <button type="button" id="zoom-out-btn-2" title="Verkleinern">-</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/simulation_preview.js', v=timestamp) }}"></script>
<script src="{{ url_for('static', filename='js/results_comparison.js', v=timestamp) }}"></script>
{% endblock %}